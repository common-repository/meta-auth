(()=>{async function t(t){var n;t.preventDefault(),(n=t.currentTarget).textContent="ACTIVATING...",n.setAttribute("disabled",!0),await e()}async function e(){const t=document.getElementById("messager"),a=t.textContent,o=document.getElementById("meta-plugin-activate-btn");if(!document.getElementById("accept_tos").checked)return void async function(t,e,a,o){n(t,a,"err",o,"ACTIVATE"),setTimeout((()=>{t.textContent=e,t.classList.remove("err")}),3e3)}(t,a,o,metaAuth.tosRequired);const c=document.querySelector("#registration_email");try{!async function(t,a,o,c,r){if(t.length>0){const s=t[0];try{const t=await ethereum.request({method:"eth_chainId"}),i=parseInt(t,16);!async function(t,a,o,c,r,s,i){networkInfo.testnets.includes(t)?async function(t,a,o){n(t,o,"err","Please switch to mainnet.","ACTIVATE");try{await ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x1"}]}),t.classList.remove("err"),t.textContent=a,o.textContent="ACTIVATE",e()}catch(t){console.log(t)}}(r,s,i):await async function(t,e,a,o,c){try{const r=await fetch(ajaxurl,{method:"POST",body:new URLSearchParams({email:t.value,address:e,plugin:"meta-auth",ticker:a,action:"meta_auth_activate_site"})}),s=await r.json();s.success?(n(o,c,"ok",s.message,"ACTIVATED"),setTimeout((()=>window.location.href=metaAuth.adminURL),3e3)):n(o,c,"err",s.message,"ACTIVATE")}catch(t){console.log(t)}}(a,o,c,r,i)}(i,a,s,networkInfo.symbols[i]??"Unknown",o,c,r)}catch(t){n(o,r,"err","Error getting the current Ethereum chainId. Please switch to mainnet.","ACTIVATE"),console.log("Error getting the current Ethereum chainId.")}}else console.log("No Ethereum accounts found.")}(await ethereum.request({method:"eth_requestAccounts"}),c,t,a,o)}catch(t){console.log(`Error requesting Ethereum accounts: ${t}`)}}function n(t,e,n,a,o){t.classList.add(n),t.textContent=a,e.textContent=o,"ACTIVATE"===o&&e.removeAttribute("disabled")}window.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("meta-plugin-activate-btn");e&&(e.removeEventListener("click",t),e.addEventListener("click",t))}))})();